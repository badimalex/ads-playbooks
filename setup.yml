---
  - hosts: app
    become: yes
    gather_facts: no
    vars:
      env_vars: |
        DOCKER_USER=badimalex
        DOCKER_PASSWORD=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
        ADS_DATABASE_URL=postgresql://ads:UNIq4rrqWXzJ5H0t@localhost/ads_microservice_production
        AUTH_DATABASE_URL=postgresql://auth:UNIq4rrqWXzJ5H0t@localhost/auth_microservice_production
        RABBITMQ_HOST=127.0.0.1
        RABBITMQ_USER=ads
        RABBITMQ_PASSWORD=UNIq4rrqWXzJ5H0t
        RACK_ENV=production
    tasks:
      - name: ensure pip
        apt:
          name: python3-pip
      - name: ensure dependencies
        pip:
          name: docker
      - name: ensure env loaded
        copy:
          content: '{{ env_vars }}'
          dest: '/{{ ansible_user }}/.env'
